$(document).ready(function(){$("#page").val(1);$("#endPagination").val(0);loadCoupons();$("#statusCouponUl li").hide();$("#statusCouponUl .active").show();$("#statusCouponUl .active").click(function(){$("#statusCouponUl li").toggle();$("#statusCouponUl .active").show()});$("#statusCouponUl li").first().nextAll("li").click(function(){$("#lista-cupons").empty();changeStatus($(this));$("#page").val(1);loadCoupons();$("#statusCouponUl li").hide();$("#statusCouponUl .active").find("A").text($(this).find("A").text());
$("#statusCouponUl .active").show()});$("#next").click(function(){loadCoupons();return!1});$("a.mark").live("click",function(){var a=$(this),b=a.data("enc-item-id");$.post("/minha-conta/meus-cupons/marcar",{encItemId:b},function(b){a.html(b.message);a.hasClass("utilizado")?a.removeClass("utilizado").addClass("naoutilizado"):a.removeClass("naoutilizado").addClass("utilizado")},"json");return!1});"1"==$("#infiniteScroll").val()&&$(window).scroll(onScroll)});
function changeStatus(a){$("#statusCouponUl li.active a").text(a.text());$("#status").val(a.children(":first").attr("id"))}
function loadCoupons(a){var b=$("#endPagination");if("1"==b)return!1;var d=$("#next"),c=$("#loading"),e=$("#scrollTriggered");d.hide();c.show();e.val("true");$.ajax({url:getCouponListUrl(),data:{page:$("#page").val(),status:$("#status").val(),timestamp:(new Date).getTime()},async:null==a?!0:a,success:function(a){if(null!=a&&""!=trim(a)){$("#lista-cupons").append(trim(a));a=$("#page");var f=parseInt(a.val());a.val(f+1);e.val("");d.show();afterLoad();c.hide();$(".seeDetails").click(function(){var a=
$(this).attr("data-item-id"),b=$("#rules_"+a);b.is(":visible")?($(".icoSee_"+a).removeClass("active"),$(".seeDetails_"+a).text("Veja mais").removeClass("vejaMenos"),$("html, body").animate({scrollTop:$(b).closest("tr").offset().top},2E3),$(b).slideUp(2E3)):loadRules($(this),$(this).attr("data-enc-item-id"),a)})}else d.hide(),b.val(1),c.hide()}})}
function loadRules(a,b,d){var c=$(a).parent().parent().find(".rules");null==$(c).html()||""==$(c).html()?$.ajax({url:"/minha-conta/meu-cupom/detalhes",data:{encCouponId:b},success:function(a){$(c).html(a);changeLessInfo(c,d)}}):changeLessInfo(c,d)}function changeLessInfo(a,b){$(a).slideDown(2E3);$(".icoSee_"+b).addClass("active");$(".seeDetails_"+b).text("Veja menos").addClass("vejaMenos")}function trim(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}
function onScroll(){!(new Boolean($("#scrollTriggered").val())).valueOf()&&$(window).scrollTop()>=$("#lista-cupons").height()&&loadCoupons(!0)}function getCouponListUrl(){return"/minha-conta/meus-cupons/lista"}function afterLoad(){}function getCouponListUrl(){return"/minha-conta/meus-cupons/lista"}function afterLoad(){};